# Load Water Intakes API

Функция для загрузки всех записей о потреблении воды с пагинацией и сортировкой.

## Endpoint

```
https://your-project.supabase.co/functions/v1/load-water-intakes
```

## Метод

**GET** - получение всех записей о потреблении воды

## Параметры запроса

| Параметр | Тип | Обязательный | Описание |
|----------|-----|--------------|----------|
| `limit` | number | ❌ | Количество записей на странице (по умолчанию: 100) |
| `offset` | number | ❌ | Смещение для пагинации (по умолчанию: 0) |
| `sort_by` | string | ❌ | Поле для сортировки (по умолчанию: `created_at`) |
| `sort_order` | string | ❌ | Порядок сортировки: `asc`, `desc` (по умолчанию: `desc`) |
| `telegram_user_id` | number | ❌ | Фильтр по ID пользователя в Telegram |

## Доступные поля для сортировки

- `created_at` - дата создания
- `telegram_user_id` - ID пользователя в Telegram
- `amount` - количество воды (`sips` или `glass`)

## Пример запроса

### Получить все записи

```bash
curl -X GET "https://your-project.supabase.co/functions/v1/load-water-intakes?limit=50&offset=0&sort_by=created_at&sort_order=desc" \
  -H "Authorization: Bearer YOUR_ANON_KEY"
```

### Получить записи конкретного пользователя

```bash
curl -X GET "https://your-project.supabase.co/functions/v1/load-water-intakes?telegram_user_id=123456789&limit=50&offset=0" \
  -H "Authorization: Bearer YOUR_ANON_KEY"
```

## Ответ

```json
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "telegram_user_id": 123456789,
      "amount": "glass",
      "created_at": "2024-01-15T10:30:00Z"
    },
    {
      "id": "uuid",
      "telegram_user_id": 123456789,
      "amount": "sips",
      "created_at": "2024-01-15T08:15:00Z"
    }
  ],
  "count": 50,
  "limit": 50,
  "offset": 0,
  "total_count": 1250,
  "total_pages": 25,
  "current_page": 1,
  "sort_by": "created_at",
  "sort_order": "desc",
  "telegram_user_id": "123456789"
}
```

## Поля записи о воде

| Поле | Тип | Описание |
|------|-----|----------|
| `id` | string | Уникальный ID записи |
| `telegram_user_id` | number | ID пользователя в Telegram |
| `amount` | string | Количество воды: `sips` (пару глотков, ~50 мл) или `glass` (стакан, ~250 мл) |
| `created_at` | string | Дата создания записи |

## Пагинация

- `count` - количество записей в текущем ответе
- `limit` - максимальное количество записей на странице
- `offset` - смещение от начала
- `total_count` - общее количество записей
- `total_pages` - общее количество страниц
- `current_page` - текущая страница

## Фильтрация по пользователю

Если указан параметр `telegram_user_id`, функция вернет только записи этого пользователя. Это полезно для получения истории потребления воды конкретного пользователя.

## Коды ошибок

- `400` - Неверные параметры сортировки или фильтрации
- `500` - Внутренняя ошибка сервера

## Особенности

- **Полная информация** - возвращает все поля записи о воде
- **Гибкая сортировка** - можно сортировать по любому доступному полю
- **Пагинация** - поддержка больших объемов данных
- **Фильтрация по пользователю** - возможность получить записи конкретного пользователя
- **CORS поддержка** - функция поддерживает кросс-доменные запросы
- **Административная функция** - предназначена для загрузки всех записей системы или записей конкретного пользователя
